
<!DOCTYPE html>
<html>
<head>
    <title>Butterfly Exit Comparison Report</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        h2 { color: #34495e; margin-top: 30px; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th { background: #3498db; color: white; padding: 12px; text-align: left; }
        td { padding: 10px; border-bottom: 1px solid #ddd; }
        tr:hover { background: #f8f9fa; }
        .metric { background: #ecf0f1; padding: 15px; border-radius: 5px; margin: 10px 0; }
        .positive { color: #27ae60; font-weight: bold; }
        .negative { color: #e74c3c; font-weight: bold; }
        .summary-box { background: #e8f4f8; border-left: 4px solid #3498db; padding: 15px; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ¦‹ Butterfly Exit Strategy Comparison Report</h1>
        <p><strong>Generated:</strong> 2025-11-17 03:32:29</p>
        
        <div class="summary-box">
            <h2>Executive Summary</h2>
            <p>Comparison of <strong>100</strong> butterfly positions exited using two methods:</p>
            <ul>
                <li><strong>Whole-Fly Exit:</strong> Single multi-leg order at mid minus haircut</li>
                <li><strong>Split-Vertical Exit:</strong> Sequential vertical spreads via ButterflyExitRouter</li>
            </ul>
        </div>
        
        <h2>ðŸ“Š Key Results</h2>
        
        <div class="metric">
            <strong>Total P&L Improvement:</strong> 
            <span class="positive">
                $10568.43 (+748.5%)
            </span>
        </div>
        
        <div class="metric">
            <strong>Average Slippage Reduction:</strong> 
            <span class="negative">
                $-0.31
            </span>
        </div>
        
        <h2>ðŸ“ˆ Summary Statistics by Exit Method</h2>
        <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pnl_sum</th>
      <th>pnl_mean</th>
      <th>pnl_median</th>
      <th>pnl_std</th>
      <th>slippage_vs_mid_mean</th>
      <th>slippage_vs_mid_median</th>
      <th>slippage_vs_mid_max</th>
      <th>slippage_pct_mean</th>
      <th>slippage_pct_median</th>
      <th>slippage_pct_max</th>
      <th>latency_ms_mean</th>
      <th>latency_ms_median</th>
      <th>latency_ms_max</th>
      <th>success_sum</th>
      <th>trade_id_count</th>
      <th>win_rate</th>
      <th>profit_factor</th>
    </tr>
    <tr>
      <th>exit_method</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>split_verticals</th>
      <td>11980.34</td>
      <td>119.80</td>
      <td>127.23</td>
      <td>84.64</td>
      <td>5.01</td>
      <td>5.02</td>
      <td>10.63</td>
      <td>2.42</td>
      <td>2.28</td>
      <td>6.52</td>
      <td>0.58</td>
      <td>0.51</td>
      <td>1.47</td>
      <td>100</td>
      <td>100</td>
      <td>90.0</td>
      <td>35.755992</td>
    </tr>
    <tr>
      <th>whole_fly</th>
      <td>1411.91</td>
      <td>14.12</td>
      <td>4.55</td>
      <td>80.98</td>
      <td>4.70</td>
      <td>3.92</td>
      <td>13.63</td>
      <td>3.92</td>
      <td>3.95</td>
      <td>4.99</td>
      <td>517.88</td>
      <td>541.99</td>
      <td>787.57</td>
      <td>100</td>
      <td>100</td>
      <td>52.0</td>
      <td>1.543955</td>
    </tr>
  </tbody>
</table>
        
        <h2>ðŸ“‹ Trade-Level Details (First 20)</h2>
        <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>trade_id</th>
      <th>symbol</th>
      <th>entry_time</th>
      <th>entry_debit</th>
      <th>underlying_price</th>
      <th>exit_method</th>
      <th>exit_credit</th>
      <th>pnl</th>
      <th>slippage_vs_mid</th>
      <th>slippage_pct</th>
      <th>latency_ms</th>
      <th>success</th>
      <th>num_warnings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>FLY_QQQ_0000</td>
      <td>QQQ</td>
      <td>2025-11-17 00:32:29.748388</td>
      <td>128.529865</td>
      <td>448.120994</td>
      <td>split_verticals</td>
      <td>264.970124</td>
      <td>136.440259</td>
      <td>6.459810</td>
      <td>2.437939</td>
      <td>0.716000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0000</td>
      <td>QQQ</td>
      <td>2025-11-17 00:32:29.748388</td>
      <td>128.529865</td>
      <td>448.120994</td>
      <td>whole_fly</td>
      <td>115.416970</td>
      <td>-13.112895</td>
      <td>5.964288</td>
      <td>4.913681</td>
      <td>408.707111</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0001</td>
      <td>QQQ</td>
      <td>2025-11-17 02:32:29.748474</td>
      <td>114.630011</td>
      <td>450.100534</td>
      <td>split_verticals</td>
      <td>88.488164</td>
      <td>-26.141847</td>
      <td>2.419521</td>
      <td>2.734288</td>
      <td>1.446000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0001</td>
      <td>QQQ</td>
      <td>2025-11-17 02:32:29.748474</td>
      <td>114.630011</td>
      <td>450.100534</td>
      <td>whole_fly</td>
      <td>21.594734</td>
      <td>-93.035277</td>
      <td>0.717288</td>
      <td>3.214807</td>
      <td>270.626743</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0002</td>
      <td>QQQ</td>
      <td>2025-11-17 01:32:29.748542</td>
      <td>93.190174</td>
      <td>448.671821</td>
      <td>split_verticals</td>
      <td>268.040159</td>
      <td>174.849984</td>
      <td>4.295038</td>
      <td>1.602386</td>
      <td>0.544000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0002</td>
      <td>QQQ</td>
      <td>2025-11-17 01:32:29.748542</td>
      <td>93.190174</td>
      <td>448.671821</td>
      <td>whole_fly</td>
      <td>202.348890</td>
      <td>109.158715</td>
      <td>9.787057</td>
      <td>4.613578</td>
      <td>579.866951</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0003</td>
      <td>QQQ</td>
      <td>2025-11-17 02:32:29.748787</td>
      <td>79.159893</td>
      <td>449.805962</td>
      <td>split_verticals</td>
      <td>235.462287</td>
      <td>156.302394</td>
      <td>5.394900</td>
      <td>2.291195</td>
      <td>0.487000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0003</td>
      <td>QQQ</td>
      <td>2025-11-17 02:32:29.748787</td>
      <td>79.159893</td>
      <td>449.805962</td>
      <td>whole_fly</td>
      <td>45.699678</td>
      <td>-33.460215</td>
      <td>1.951541</td>
      <td>4.095468</td>
      <td>613.026862</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0004</td>
      <td>QQQ</td>
      <td>2025-11-17 01:32:29.748843</td>
      <td>131.386710</td>
      <td>450.320723</td>
      <td>split_verticals</td>
      <td>276.214957</td>
      <td>144.828247</td>
      <td>3.089152</td>
      <td>1.118387</td>
      <td>0.410000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0004</td>
      <td>QQQ</td>
      <td>2025-11-17 01:32:29.748843</td>
      <td>131.386710</td>
      <td>450.320723</td>
      <td>whole_fly</td>
      <td>33.483134</td>
      <td>-97.903575</td>
      <td>1.186980</td>
      <td>3.423639</td>
      <td>635.687285</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0005</td>
      <td>QQQ</td>
      <td>2025-11-16 23:32:29.748911</td>
      <td>126.187922</td>
      <td>451.082011</td>
      <td>split_verticals</td>
      <td>125.064736</td>
      <td>-1.123187</td>
      <td>5.257056</td>
      <td>4.203468</td>
      <td>0.811000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0005</td>
      <td>QQQ</td>
      <td>2025-11-16 23:32:29.748911</td>
      <td>126.187922</td>
      <td>451.082011</td>
      <td>whole_fly</td>
      <td>42.637612</td>
      <td>-83.550310</td>
      <td>1.414080</td>
      <td>3.210048</td>
      <td>412.460525</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0006</td>
      <td>QQQ</td>
      <td>2025-11-16 23:32:29.748980</td>
      <td>105.680713</td>
      <td>450.090852</td>
      <td>split_verticals</td>
      <td>231.610257</td>
      <td>125.929545</td>
      <td>3.686494</td>
      <td>1.591680</td>
      <td>0.512000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0006</td>
      <td>QQQ</td>
      <td>2025-11-16 23:32:29.748980</td>
      <td>105.680713</td>
      <td>450.090852</td>
      <td>whole_fly</td>
      <td>113.255840</td>
      <td>7.575127</td>
      <td>5.153678</td>
      <td>4.352419</td>
      <td>506.382567</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0007</td>
      <td>QQQ</td>
      <td>2025-11-17 01:32:29.749050</td>
      <td>98.388065</td>
      <td>449.546660</td>
      <td>split_verticals</td>
      <td>264.130945</td>
      <td>165.742881</td>
      <td>5.586943</td>
      <td>2.115217</td>
      <td>0.479000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0007</td>
      <td>QQQ</td>
      <td>2025-11-17 01:32:29.749050</td>
      <td>98.388065</td>
      <td>449.546660</td>
      <td>whole_fly</td>
      <td>74.594611</td>
      <td>-23.793454</td>
      <td>2.316320</td>
      <td>3.011692</td>
      <td>537.298784</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0008</td>
      <td>QQQ</td>
      <td>2025-11-17 02:32:29.749127</td>
      <td>107.035626</td>
      <td>449.623574</td>
      <td>split_verticals</td>
      <td>163.097654</td>
      <td>56.062028</td>
      <td>1.414675</td>
      <td>0.867379</td>
      <td>0.356000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0008</td>
      <td>QQQ</td>
      <td>2025-11-17 02:32:29.749127</td>
      <td>107.035626</td>
      <td>449.623574</td>
      <td>whole_fly</td>
      <td>157.136610</td>
      <td>50.100985</td>
      <td>7.375719</td>
      <td>4.483384</td>
      <td>655.081138</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0009</td>
      <td>QQQ</td>
      <td>2025-11-16 23:32:29.749174</td>
      <td>148.432885</td>
      <td>449.525042</td>
      <td>split_verticals</td>
      <td>100.822697</td>
      <td>-47.610188</td>
      <td>2.593269</td>
      <td>2.572108</td>
      <td>0.510000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0009</td>
      <td>QQQ</td>
      <td>2025-11-16 23:32:29.749174</td>
      <td>148.432885</td>
      <td>449.525042</td>
      <td>whole_fly</td>
      <td>53.177971</td>
      <td>-95.254914</td>
      <td>1.869246</td>
      <td>3.395713</td>
      <td>361.627030</td>
      <td>True</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
        
        <h2>ðŸ’¡ Conclusions</h2>
        <div class="summary-box">
            <p>Based on this comprehensive backtest analysis:</p>
            <ul>
                <li>Split-vertical exits generated <strong>$10568.43</strong> additional profit (+748.5%)</li>
                <li>Average slippage was reduced by <strong>$-0.31</strong> per trade</li>
                <li>The sequential vertical execution provides superior price realization</li>
            </ul>
            <p><strong>Recommendation:</strong> Adopt split-vertical exit method as default for all butterfly positions.</p>
        </div>
    </div>
</body>
</html>
