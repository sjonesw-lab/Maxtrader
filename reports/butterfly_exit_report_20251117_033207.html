
<!DOCTYPE html>
<html>
<head>
    <title>Butterfly Exit Comparison Report</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        h2 { color: #34495e; margin-top: 30px; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th { background: #3498db; color: white; padding: 12px; text-align: left; }
        td { padding: 10px; border-bottom: 1px solid #ddd; }
        tr:hover { background: #f8f9fa; }
        .metric { background: #ecf0f1; padding: 15px; border-radius: 5px; margin: 10px 0; }
        .positive { color: #27ae60; font-weight: bold; }
        .negative { color: #e74c3c; font-weight: bold; }
        .summary-box { background: #e8f4f8; border-left: 4px solid #3498db; padding: 15px; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ¦‹ Butterfly Exit Strategy Comparison Report</h1>
        <p><strong>Generated:</strong> 2025-11-17 03:32:07</p>
        
        <div class="summary-box">
            <h2>Executive Summary</h2>
            <p>Comparison of <strong>100</strong> butterfly positions exited using two methods:</p>
            <ul>
                <li><strong>Whole-Fly Exit:</strong> Single multi-leg order at mid minus haircut</li>
                <li><strong>Split-Vertical Exit:</strong> Sequential vertical spreads via ButterflyExitRouter</li>
            </ul>
        </div>
        
        <h2>ðŸ“Š Key Results</h2>
        
        <div class="metric">
            <strong>Total P&L Improvement:</strong> 
            <span class="positive">
                $9547.67 (+491.3%)
            </span>
        </div>
        
        <div class="metric">
            <strong>Average Slippage Reduction:</strong> 
            <span class="positive">
                $0.15
            </span>
        </div>
        
        <h2>ðŸ“ˆ Summary Statistics by Exit Method</h2>
        <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pnl_sum</th>
      <th>pnl_mean</th>
      <th>pnl_median</th>
      <th>pnl_std</th>
      <th>slippage_vs_mid_mean</th>
      <th>slippage_vs_mid_median</th>
      <th>slippage_vs_mid_max</th>
      <th>slippage_pct_mean</th>
      <th>slippage_pct_median</th>
      <th>slippage_pct_max</th>
      <th>latency_ms_mean</th>
      <th>latency_ms_median</th>
      <th>latency_ms_max</th>
      <th>success_sum</th>
      <th>trade_id_count</th>
      <th>win_rate</th>
      <th>profit_factor</th>
    </tr>
    <tr>
      <th>exit_method</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>split_verticals</th>
      <td>11490.98</td>
      <td>114.91</td>
      <td>117.48</td>
      <td>74.53</td>
      <td>4.75</td>
      <td>4.39</td>
      <td>10.81</td>
      <td>2.28</td>
      <td>2.25</td>
      <td>7.95</td>
      <td>0.50</td>
      <td>0.33</td>
      <td>15.76</td>
      <td>100</td>
      <td>100</td>
      <td>92.0</td>
      <td>71.873195</td>
    </tr>
    <tr>
      <th>whole_fly</th>
      <td>1943.31</td>
      <td>19.43</td>
      <td>19.29</td>
      <td>83.81</td>
      <td>4.90</td>
      <td>4.50</td>
      <td>17.75</td>
      <td>4.00</td>
      <td>4.03</td>
      <td>4.96</td>
      <td>507.85</td>
      <td>524.67</td>
      <td>798.62</td>
      <td>100</td>
      <td>100</td>
      <td>56.0</td>
      <td>1.784934</td>
    </tr>
  </tbody>
</table>
        
        <h2>ðŸ“‹ Trade-Level Details (First 20)</h2>
        <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>trade_id</th>
      <th>symbol</th>
      <th>entry_time</th>
      <th>entry_debit</th>
      <th>underlying_price</th>
      <th>exit_method</th>
      <th>exit_credit</th>
      <th>pnl</th>
      <th>slippage_vs_mid</th>
      <th>slippage_pct</th>
      <th>latency_ms</th>
      <th>success</th>
      <th>num_warnings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>FLY_QQQ_0000</td>
      <td>QQQ</td>
      <td>2025-11-17 01:32:07.461355</td>
      <td>95.487389</td>
      <td>450.367745</td>
      <td>split_verticals</td>
      <td>298.814561</td>
      <td>203.327172</td>
      <td>10.814203</td>
      <td>3.619035</td>
      <td>0.510000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0000</td>
      <td>QQQ</td>
      <td>2025-11-17 01:32:07.461355</td>
      <td>95.487389</td>
      <td>450.367745</td>
      <td>whole_fly</td>
      <td>298.178834</td>
      <td>202.691445</td>
      <td>11.449930</td>
      <td>3.697954</td>
      <td>453.536861</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0001</td>
      <td>QQQ</td>
      <td>2025-11-17 02:32:07.461987</td>
      <td>74.904374</td>
      <td>450.591195</td>
      <td>split_verticals</td>
      <td>238.164315</td>
      <td>163.259941</td>
      <td>2.413718</td>
      <td>1.013468</td>
      <td>0.229000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0001</td>
      <td>QQQ</td>
      <td>2025-11-17 02:32:07.461987</td>
      <td>74.904374</td>
      <td>450.591195</td>
      <td>whole_fly</td>
      <td>232.220463</td>
      <td>157.316089</td>
      <td>7.947890</td>
      <td>3.309299</td>
      <td>286.547446</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0002</td>
      <td>QQQ</td>
      <td>2025-11-17 00:32:07.462059</td>
      <td>57.866248</td>
      <td>451.694526</td>
      <td>split_verticals</td>
      <td>153.756484</td>
      <td>95.890236</td>
      <td>1.566474</td>
      <td>1.018802</td>
      <td>0.230000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0002</td>
      <td>QQQ</td>
      <td>2025-11-17 00:32:07.462059</td>
      <td>57.866248</td>
      <td>451.694526</td>
      <td>whole_fly</td>
      <td>38.072105</td>
      <td>-19.794143</td>
      <td>1.863908</td>
      <td>4.667236</td>
      <td>730.447625</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0003</td>
      <td>QQQ</td>
      <td>2025-11-16 23:32:07.462112</td>
      <td>86.988150</td>
      <td>450.230935</td>
      <td>split_verticals</td>
      <td>177.908644</td>
      <td>90.920495</td>
      <td>2.190372</td>
      <td>1.231178</td>
      <td>0.341000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0003</td>
      <td>QQQ</td>
      <td>2025-11-16 23:32:07.462112</td>
      <td>86.988150</td>
      <td>450.230935</td>
      <td>whole_fly</td>
      <td>93.942092</td>
      <td>6.953942</td>
      <td>3.720909</td>
      <td>3.809947</td>
      <td>400.644287</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0004</td>
      <td>QQQ</td>
      <td>2025-11-16 23:32:07.462159</td>
      <td>90.752648</td>
      <td>449.690146</td>
      <td>split_verticals</td>
      <td>212.295702</td>
      <td>121.543054</td>
      <td>5.159010</td>
      <td>2.430106</td>
      <td>0.297000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0004</td>
      <td>QQQ</td>
      <td>2025-11-16 23:32:07.462159</td>
      <td>90.752648</td>
      <td>449.690146</td>
      <td>whole_fly</td>
      <td>210.393317</td>
      <td>119.640669</td>
      <td>7.061394</td>
      <td>3.247294</td>
      <td>433.176469</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0005</td>
      <td>QQQ</td>
      <td>2025-11-17 02:32:07.462203</td>
      <td>107.103734</td>
      <td>451.033050</td>
      <td>split_verticals</td>
      <td>258.659286</td>
      <td>151.555552</td>
      <td>5.719474</td>
      <td>2.211200</td>
      <td>0.459000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0005</td>
      <td>QQQ</td>
      <td>2025-11-17 02:32:07.462203</td>
      <td>107.103734</td>
      <td>451.033050</td>
      <td>whole_fly</td>
      <td>70.634396</td>
      <td>-36.469338</td>
      <td>2.289374</td>
      <td>3.139407</td>
      <td>543.607018</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0006</td>
      <td>QQQ</td>
      <td>2025-11-17 00:32:07.462247</td>
      <td>120.591615</td>
      <td>451.709021</td>
      <td>split_verticals</td>
      <td>118.270051</td>
      <td>-2.321564</td>
      <td>1.888842</td>
      <td>1.597059</td>
      <td>0.215000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0006</td>
      <td>QQQ</td>
      <td>2025-11-17 00:32:07.462247</td>
      <td>120.591615</td>
      <td>451.709021</td>
      <td>whole_fly</td>
      <td>62.257803</td>
      <td>-58.333812</td>
      <td>3.200370</td>
      <td>4.889184</td>
      <td>565.999550</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0007</td>
      <td>QQQ</td>
      <td>2025-11-17 00:32:07.462341</td>
      <td>133.945455</td>
      <td>450.508208</td>
      <td>split_verticals</td>
      <td>231.906406</td>
      <td>97.960951</td>
      <td>5.462314</td>
      <td>2.355396</td>
      <td>0.321000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0007</td>
      <td>QQQ</td>
      <td>2025-11-17 00:32:07.462341</td>
      <td>133.945455</td>
      <td>450.508208</td>
      <td>whole_fly</td>
      <td>218.167459</td>
      <td>84.222004</td>
      <td>9.943540</td>
      <td>4.359080</td>
      <td>316.875646</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0008</td>
      <td>QQQ</td>
      <td>2025-11-17 02:32:07.462395</td>
      <td>57.194112</td>
      <td>449.809758</td>
      <td>split_verticals</td>
      <td>290.084563</td>
      <td>232.890451</td>
      <td>5.958903</td>
      <td>2.054195</td>
      <td>0.294000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0008</td>
      <td>QQQ</td>
      <td>2025-11-17 02:32:07.462395</td>
      <td>57.194112</td>
      <td>449.809758</td>
      <td>whole_fly</td>
      <td>98.797341</td>
      <td>41.603229</td>
      <td>3.384364</td>
      <td>3.312104</td>
      <td>604.573329</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0009</td>
      <td>QQQ</td>
      <td>2025-11-16 23:32:07.462438</td>
      <td>69.687414</td>
      <td>448.888662</td>
      <td>split_verticals</td>
      <td>208.214141</td>
      <td>138.526727</td>
      <td>6.758688</td>
      <td>3.246027</td>
      <td>0.383000</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>FLY_QQQ_0009</td>
      <td>QQQ</td>
      <td>2025-11-16 23:32:07.462438</td>
      <td>69.687414</td>
      <td>448.888662</td>
      <td>whole_fly</td>
      <td>143.184259</td>
      <td>73.496844</td>
      <td>5.585623</td>
      <td>3.754539</td>
      <td>656.304394</td>
      <td>True</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
        
        <h2>ðŸ’¡ Conclusions</h2>
        <div class="summary-box">
            <p>Based on this comprehensive backtest analysis:</p>
            <ul>
                <li>Split-vertical exits generated <strong>$9547.67</strong> additional profit (+491.3%)</li>
                <li>Average slippage was reduced by <strong>$0.15</strong> per trade</li>
                <li>The sequential vertical execution provides superior price realization</li>
            </ul>
            <p><strong>Recommendation:</strong> Adopt split-vertical exit method as default for all butterfly positions.</p>
        </div>
    </div>
</body>
</html>
